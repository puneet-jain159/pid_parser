# PID Parser - Cursor Rules

## Project Context
This is a PID (P&ID - Piping and Instrumentation Diagram) parser project that extracts metadata from engineering drawings using OCR and vision models.

## Code Style
- Follow PEP 8 Python style guide
- Use type hints for all function signatures
- Use docstrings for all classes and functions (Google style)
- Maximum line length: 100 characters

## Databricks Notebooks
- All Databricks notebooks start with `# Databricks notebook source`
- Use `# COMMAND ----------` to separate cells
- Markdown cells use `# MAGIC %md` prefix
- Every markdown comment should start with `# MAGIC`

## File Organization
- Core logic should be in `src/pid_parser/`
- Databricks notebooks go in `notebooks/`
- Tests go in `tests/`
- Documentation goes in `docs/`

## Naming Conventions
- Classes: PascalCase
- Functions/variables: snake_case
- Constants: UPPER_SNAKE_CASE
- Private methods: prefix with single underscore `_`

## Error Handling
- Use specific exception types
- Include meaningful error messages
- Log errors appropriately
- Handle edge cases gracefully

## MLflow Integration
- Use MLflow tracing for all LLM calls
- Log parameters, metrics, and artifacts
- Use appropriate span types (CHAIN, LLM, etc.)

## Testing
- Write unit tests for all core functions
- Use pytest for testing
- Aim for >80% code coverage
- Test edge cases and error conditions

## Documentation
- Update README.md for user-facing changes
- Add technical design docs in `docs/technical_design/`
- Document API changes in `docs/api/`
- Keep architecture diagrams in `docs/architecture/`

## Dependencies
- Keep requirements.txt up to date
- Pin major versions for stability
- Document why each dependency is needed

## Git Workflow
- Use meaningful commit messages
- Create feature branches for new work
- Keep commits focused and atomic

